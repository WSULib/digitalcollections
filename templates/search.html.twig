{% import "macros.html.twig" as m %}
{% extends "base.html.twig" %}

{% block title %}{{ data.id }}{% endblock %}
{% block head %}
    {{ parent() }}
{% endblock %}

{# search form in header #}
{% block search_form_string %}{{search_params.q}}{% endblock search_form_string %}

{% block content %}

<div class="container cached">
    <div class="sub-header">
       <h2>
            Search Results
        </h2>
        
        <div class="row">
            <div class="col-md-6 pull-left">
                <ul id="search_results_ul">
                    <li><span id='num_results'></span> Objects</li>
                    <!-- <li>&quot;<span id='q_string'></span>&quot;</li>-->
                </ul>                
            </div>
            <div class="col-md-6 pull-right" style="text-align:right;">                
	            <!-- <ul style="width:50%; float:right; text-align:right;"> -->
	            <ul >                	                    		        	
	                <li>
	                	<span>Items per page:</span>
	                	<select class="resPerPage">                    		
	                		<option value=12>12</option>
	                		<option value=20>20</option>
	                		<option value=50>50</option>			                		
	            		</select>
	        		</li>
	        		<!-- old selector -->
                    <li id="toggleView">
	                	<span style="cursor:pointer;" onclick="toggleResultsView('search'); return false;">Toggle <i class="icon-list4"></i> / <i class="icon-layout"></i></span>
                    </li>                            
	        	</ul>
        	</div>
    	</div>
    </div><!-- /row for sub-header -->
    
    <div id="facets_container" class="facets">
        <ul class="facet_container filter" id="search_facet">                	
            <li>
                <h3 class="tree-toggler">Refine Results</h3>
                <ul class="tree facet_list" id="search_facet_box">
                    <form onsubmit="refineByKeyWord('search','same'); return false;" role="form">
                        <input id="refine_input" placeholder='Type in word or phrase' class="search-filter">                                                                
						<label class="radio-inline">
							<input type="radio" id="metadata" name="refine_type" value="metadata"> Item Record Only
						</label>
						<label class="radio-inline">
							<input type="radio" id="fulltext" name="refine_type" value="fulltext"> Full-Text Only
						</label>
						<label class="radio-inline">
							<input checked type="radio" id="both" name="refine_type" value="both"> Both
						</label>
                    </form>
                </ul>
            </li>
        </ul>

        <!-- ContentModel -->
        <ul class="facet_container filter" id="rels_hasContentModel_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Content Type ({{data.response.solr_results.facet_counts.facet_fields.human_hasContentModel|length}})</h3>
	        	<ul class="tree facet_list" id="rels_hasContentModel_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.human_hasContentModel %}
		        		<li>{{m.facetBuilder("add", "human_hasContentModel", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>

	    <!-- ContentModel -->
        <ul class="facet_container filter" id="rels_isMemberOfCollection_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Collection ({{data.response.solr_results.facet_counts.facet_fields.human_isMemberOfCollection|length}})</h3>
	        	<ul class="tree facet_list" id="rels_isMemberOfCollection_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.human_isMemberOfCollection %}
		        		<li>{{m.facetBuilder("add", "human_isMemberOfCollection", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>

	    <!-- MODS Year -->
        <ul class="facet_container filter" id="facet_mods_year_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Date ({{data.response.solr_results.facet_counts.facet_fields.facet_mods_year|length}})</h3>
	        	<ul class="tree facet_list" id="facet_mods_year_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.facet_mods_year %}
		        		<li>{{m.facetBuilder("add", "facet_mods_year", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>

	    <!-- DC Subject -->
        <ul class="facet_container filter" id="dc_subject_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Subject ({{data.response.solr_results.facet_counts.facet_fields.dc_subject|length}})</h3>
	        	<ul class="tree facet_list" id="dc_subject_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.dc_subject %}
		        		<li>{{m.facetBuilder("add", "dc_subject", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>

	    <!-- Creator -->
        <ul class="facet_container filter" id="dc_creator_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Creator ({{data.response.solr_results.facet_counts.facet_fields.dc_creator|length}})</h3>
	        	<ul class="tree facet_list" id="dc_creator_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.dc_creator %}
		        		<li>{{m.facetBuilder("add", "dc_creator", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>

	    <!-- Coverage -->
        <ul class="facet_container filter" id="dc_coverage_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Coverage ({{data.response.solr_results.facet_counts.facet_fields.dc_coverage|length}})</h3>
	        	<ul class="tree facet_list" id="dc_coverage_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.dc_coverage %}
		        		<li>{{m.facetBuilder("add", "dc_coverage", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>

	    <!-- Language -->
        <ul class="facet_container filter" id="dc_language_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Language ({{data.response.solr_results.facet_counts.facet_fields.dc_language|length}})</h3>
	        	<ul class="tree facet_list" id="dc_language_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.dc_language %}
		        		<li>{{m.facetBuilder("add", "dc_language", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>

	    <!-- Publisher -->
        <ul class="facet_container filter" id="dc_publisher_facet"><li>
        	<h3 class="tree-toggler"><span class="icon-minus-thin"></span>Publisher ({{data.response.solr_results.facet_counts.facet_fields.dc_publisher|length}})</h3>
	        	<ul class="tree facet_list" id="dc_publisher_list">
	        		{% for facet_value in data.response.solr_results.facet_counts.facet_fields.dc_publisher %}
		        		<li>{{m.facetBuilder("add", "dc_publisher", facet_value[0], facet_value[1], true, query_string)}}</li>
	        		{% endfor %}
	        	</ul>
	        </li>
	    </ul>
        
    </div><!-- /facets -->

    <div class="main-container">
    	
    	<!-- filters -->
        <div class="row-fluid filtered-by refined-by">
        	{% for fq in search_params.fq %}
        		<span class="facet-item"><a href="{{path_for('search') ~ "?" ~ del_param_from_query_string(QueryBuilder, fq, query_string)}}"><i class="icon-delete"></i> <span class="facet_name">{{ facet_map[fq|split(":")[0]] }}</span>: {{ fq|split(":")|slice(1,3)|join(":") }}</a></span>
        {% endfor %}
        </div>

        <!-- results -->
        <ul class="row-fluid objects-container" id="results_container" style="display: block; position: relative;">

        	{% for doc in data.response.solr_results.response.docs %}
	        	<li class="obj-cnt object-container-list">
				    <div class="crop">
				        <a href="/item/{{doc.id}}">
		                	<img src="/item/{{doc.id}}/thumbnail" width="100%" alt="White Star Refining Company. Exterior.">				            
				        </a>
				    </div>
				    <h3>
				        <a href="/item/{{doc.id}}">{{doc.dc_title[0]}}<br> </a>
				    </h3>
				    <!-- what is this reserved for? -->
				    <h4></h4>
				    <p class="truncate" style="margin:0px;">{{(doc.dc_description[0]|length > 500 ? doc.dc_description[0]|slice(0, 500) ~ '&hellip;' : doc.dc_description[0])|raw}}</p>    
				</li>
			{% endfor %}

        </ul>
        
        <!-- pagination -->
        <div class="pagination-centered"></div>
    </div><!-- /objects -->
      
</div> <!-- /container -->

{% endblock %}
